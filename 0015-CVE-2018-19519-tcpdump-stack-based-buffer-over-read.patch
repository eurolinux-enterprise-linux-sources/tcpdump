From bbae61cda27b8d565456c95a697d9e7ed3298937 Mon Sep 17 00:00:00 2001
From: rpm-build <rpm-build>
Date: Tue, 8 Oct 2019 14:32:32 +0200
Subject: [PATCH] 
 0015-CVE-2018-19519-tcpdump-stack-based-buffer-over-read.patch

---
 print-hncp.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/print-hncp.c b/print-hncp.c
index 11a6a93..7537a0d 100644
--- a/print-hncp.c
+++ b/print-hncp.c
@@ -229,6 +229,8 @@ print_prefix(netdissect_options *ndo, const u_char *prefix, u_int max_length)
         plenbytes += 1 + IPV4_MAPPED_HEADING_LEN;
     } else {
         plenbytes = decode_prefix6(ndo, prefix, max_length, buf, sizeof(buf));
+        if (plenbytes < 0)
+            return plenbytes;
     }
 
     ND_PRINT((ndo, "%s", buf));
-- 
2.21.0

